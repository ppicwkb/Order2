<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Order WKB</title>

<link rel="stylesheet" href="styles.css">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
</head>
<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-6 lg:py-8">
        <div class="glass-effect rounded-2xl card-shadow p-6 lg:p-8 mb-6 border border-white/20">
            <div class="text-center mb-8">
                <h1 class="text-3xl lg:text-4xl font-bold gradient-text mb-2"> Monitoring Order WKB</h1>
                <p class="text-gray-600 text-sm lg:text-base">By PPIC</p>
            </div>
            
            <!-- Filter Section -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
                <div class="relative group">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                        Produk ID
                    </label>
                    <div class="relative">
                        <input type="text" id="produkFilter" placeholder="Search Produk ID..." 
                               class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl input-focus bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400">
                        <button type="button" onclick="toggleDropdown('produkSuggestions')" class="absolute right-3 top-3 text-gray-400 hover:text-blue-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="produkSuggestions" class="absolute z-20 w-full glass-effect border border-gray-200 rounded-xl mt-2 hidden filter-dropdown shadow-xl"></div>
                </div>
                
                <div class="relative group">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        Packing
                    </label>
                    <div class="relative">
                        <input type="text" id="packingFilter" placeholder="Search Packing..." 
                               class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl input-focus bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400">
                        <button type="button" onclick="toggleDropdown('packingSuggestions')" class="absolute right-3 top-3 text-gray-400 hover:text-green-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="packingSuggestions" class="absolute z-20 w-full glass-effect border border-gray-200 rounded-xl mt-2 hidden filter-dropdown shadow-xl"></div>
                </div>
                
                <div class="relative group">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>
                        Brand
                    </label>
                    <div class="relative">
                        <input type="text" id="brandFilter" placeholder="Search Brand..." 
                               class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl input-focus bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400">
                        <button type="button" onclick="toggleDropdown('brandSuggestions')" class="absolute right-3 top-3 text-gray-400 hover:text-purple-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="brandSuggestions" class="absolute z-20 w-full glass-effect border border-gray-200 rounded-xl mt-2 hidden filter-dropdown shadow-xl"></div>
                </div>
                
                <div class="relative group">
                    <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="w-2 h-2 bg-orange-500 rounded-full mr-2"></span>
                        PO
                    </label>
                    <div class="relative">
                        <input type="text" id="poFilter" placeholder="Search PO..." 
                               class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl input-focus bg-white/80 backdrop-blur-sm text-gray-800 placeholder-gray-400">
                        <button type="button" onclick="toggleDropdown('poSuggestions')" class="absolute right-3 top-3 text-gray-400 hover:text-orange-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="poSuggestions" class="absolute z-20 w-full glass-effect border border-gray-200 rounded-xl mt-2 hidden filter-dropdown shadow-xl"></div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row flex-wrap gap-3 lg:gap-4 mb-8">
                <button onclick="clearFilters()" class="btn-hover px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl font-medium shadow-lg flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Clear Filters
                </button>
                
                <!-- Zoom Controls -->
                <div class="flex items-center gap-2 glass-effect px-4 py-3 rounded-xl border border-white/20">
                    <button onclick="zoomOut()" class="btn-hover p-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"></path>
                        </svg>
                    </button>
                    <span id="zoomLevel" class="text-sm font-semibold text-gray-700 min-w-[60px] text-center">100%</span>
                    <button onclick="zoomIn()" class="btn-hover p-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path>
                        </svg>
                    </button>
                    <button onclick="resetZoom()" class="btn-hover px-3 py-2 bg-gradient-to-r from-gray-400 to-gray-500 text-white rounded-lg text-xs font-medium shadow-md hover:shadow-lg transition-all">
                        Reset
                    </button>
                </div>
                
                <button onclick="window.open('https://ppicwkb.github.io/Order/', '_blank')" class="btn-hover px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl font-medium shadow-lg flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
</svg>

                    Lihat semua
                </button>
                <button onclick="exportToPDF()" class="btn-hover px-6 py-3 bg-gradient-to-r from-red-500 to-rose-600 text-white rounded-xl font-medium shadow-lg flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    Export PDF
                </button>
                <div class="sm:ml-auto flex flex-col sm:flex-row gap-3">
                    <div id="lastModified" class="glass-effect text-sm font-semibold text-gray-700 px-4 py-3 rounded-xl border border-white/20 flex items-center gap-2">
                        <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                        <span>Checking updates...</span>
                    </div>
                    <div id="recordCount" class="glass-effect text-sm font-semibold text-gray-700 px-4 py-3 rounded-xl border border-white/20 flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                        Loading...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Loading State -->
        <div id="loadingState" class="glass-effect rounded-2xl card-shadow p-8 lg:p-12 text-center border border-white/20">
            <div class="relative mx-auto mb-6 w-16 h-16">
                <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-200"></div>
                <div class="animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent absolute top-0"></div>
            </div>
            <h3 class="text-xl font-semibold text-gray-800 mb-2">Loading Data</h3>
            <p class="text-gray-600">Fetching data ...</p>
            <div class="mt-4 flex justify-center">
                <div class="flex space-x-1">
                    <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce"></div>
                    <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                    <div class="w-2 h-2 bg-blue-600 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                </div>
            </div>
        </div>
        
        <!-- Data Table -->
        <div id="dataContainer" class="glass-effect rounded-2xl card-shadow overflow-hidden hidden border border-white/20">
            <div class="overflow-x-auto table-scroll">
                <div id="tableWrapper" class="transition-transform duration-300 origin-top-left" style="transform: scale(1);">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 text-white">
                            <tr id="tableHeader"></tr>
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-gray-100 bg-white/50"></tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Error State -->
        <div id="errorState" class="glass-effect rounded-2xl card-shadow p-8 lg:p-12 text-center hidden border border-white/20">
            <div class="mx-auto mb-6 w-20 h-20 bg-red-100 rounded-full flex items-center justify-center">
                <svg class="w-10 h-10 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                </svg>
            </div>
            <h3 class="text-xl font-semibold text-gray-800 mb-2">Error Loading Data</h3>
            <p class="text-gray-600 mb-6 max-w-md mx-auto">Unable to fetch data from Google Sheets. Please check the connection and try again.</p>
            <button onclick="loadData()" class="btn-hover px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-medium shadow-lg flex items-center justify-center gap-2 mx-auto">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                Retry Loading
            </button>
        </div>
    </div>

        <script src="script.js"></script>
    </body>
</html>
